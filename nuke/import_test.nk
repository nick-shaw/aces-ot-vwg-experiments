#! /Applications/Nuke15.0v1/Nuke15.0v1.app/Contents/MacOS/libnuke-15.0.1.dylib -nx
version 15.0 v1
define_window_layout_xml {<?xml version="1.0" encoding="UTF-8"?>
<layout version="1.0">
    <window x="0" y="25" w="1920" h="1147" maximized="1" screen="0">
        <splitter orientation="1">
            <split size="40"/>
            <dock id="" hideTitles="1" activePageId="Toolbar.1">
                <page id="Toolbar.1"/>
            </dock>
            <split size="1257" stretch="1"/>
            <splitter orientation="2">
                <split size="662"/>
                <dock id="" activePageId="Viewer.1">
                    <page id="Viewer.1"/>
                </dock>
                <split size="465"/>
                <dock id="" activePageId="DAG.1" focus="true">
                    <page id="DAG.1"/>
                    <page id="Curve Editor.1"/>
                    <page id="DopeSheet.1"/>
                    <page id="DAG.2"/>
                    <page id="DAG.3"/>
                    <page id="DAG.4"/>
                </dock>
            </splitter>
            <split size="615"/>
            <dock id="" activePageId="Properties.1">
                <page id="Properties.1"/>
                <page id="uk.co.thefoundry.backgroundrenderview.1"/>
                <page id="Scenegraph.1"/>
            </dock>
        </splitter>
    </window>
</layout>
}
Root {
 inputs 0
 name /Users/nick/github/aces-ot-vwg-experiments/nuke/import_test.nk
 format "2048 1556 0 0 2048 1556 1 2K_Super_35(full-ap)"
 proxy_type scale
 proxy_format "1024 778 0 0 1024 778 1 1K_Super_35(full-ap)"
 colorManagement Nuke
 OCIO_config fn-nuke_studio-config-v1.0.0_aces-v1.3_ocio-v2.1
 workingSpaceLUT linear
 monitorLut sRGB
 monitorOutLUT rec709
 int8Lut sRGB
 int16Lut sRGB
 logLut Cineon
 floatLut linear
}
Group {
 inputs 0
 name Dominant_Wavelength
 xpos 197
 ypos -214
 addUserKnob {20 User}
 addUserKnob {3 start_frequency l "start frequency"}
 start_frequency 360
 addUserKnob {3 end_frequency l "end frequency"}
 end_frequency 830
 addUserKnob {3 frequency_samples l "frequency samples"}
 frequency_samples 100
 addUserKnob {3 purple_samples l "purple samples"}
 purple_samples 10
 addUserKnob {7 ACEScct_start l "ACEScct start" R -0.5 0.5}
 addUserKnob {7 ACEScct_end l "ACEScct end" R 0.5 1.5}
 ACEScct_end 1
 addUserKnob {3 ACEScct_samples l "ACEScct samples"}
 ACEScct_samples 1920
}
 Constant {
  inputs 0
  channels rgb
  name Constant1
  xpos -36
  ypos -274
 }
 Reformat {
  type "to box"
  box_width {{parent.ACEScct_samples}}
  box_height {{"parent.frequency_samples + parent.purple_samples"}}
  box_fixed true
  name Reformat1
  xpos -36
  ypos -185
 }
set N78437200 [stack 0]
 Expression {
  expr0 "start + range * x / (width - 1)"
  expr1 "start + range * x / (width - 1)"
  expr2 "start + range * x / (width - 1)"
  name Ramp
  xpos 147
  ypos -185
  addUserKnob {20 User}
  addUserKnob {7 start R -0.5 0.5}
  start {{parent.ACEScct_start}}
  addUserKnob {7 range R 0 2}
  range {{"parent.ACEScct_end - parent.ACEScct_start"}}
 }
 Group {
  name LogConvert_ACESLog
  xpos 147
  ypos -144
  addUserKnob {20 ACESLog_tab l ACESLog}
  addUserKnob {4 operation M {log2lin lin2log}}
  addUserKnob {4 type M {ACEScct ACEScc ACESproxy}}
 }
  Input {
   inputs 0
   name Input
   xpos -40
   ypos -10
  }
  Dot {
   name Dot1
   xpos -6
   ypos 74
  }
set N78599200 [stack 0]
  Dot {
   name Dot2
   xpos 234
   ypos 74
  }
set Nd975d400 [stack 0]
  Dot {
   name Dot3
   xpos 474
   ypos 74
  }
set Ne724a800 [stack 0]
  Expression {
   expr0 r<0?0:((log(r)/log(2)+2.5)*50+425)/1023
   expr1 g<0?0:((log(g)/log(2)+2.5)*50+425)/1023
   expr2 b<0?0:((log(b)/log(2)+2.5)*50+425)/1023
   channel3 none
   name lin2log3
   label ACESproxy
   xpos 440
   ypos 108
  }
push $Ne724a800
  Expression {
   expr0 pow(2,((r*1023)-425)/50-2.5)
   expr1 pow(2,((g*1023)-425)/50-2.5)
   expr2 pow(2,((b*1023)-425)/50-2.5)
   channel3 none
   name log2lin2
   label ACESproxy
   xpos 322
   ypos 107
  }
  Switch {
   inputs 2
   which {{parent.operation}}
   name Operation2
   xpos 440
   ypos 190
  }
push $Nd975d400
  Expression {
   expr0 r<0?(log(pow(2,-16))/log(2)+9.72)/17.52:r<pow(2,-15)?(log(pow(2,-16)+r*0.5)/log(2)+9.72)/17.52:(log(r)/log(2)+9.72)/17.52
   expr1 g<0?(log(pow(2,-16))/log(2)+9.72)/17.52:g<pow(2,-15)?(log(pow(2,-16)+g*0.5)/log(2)+9.72)/17.52:(log(g)/log(2)+9.72)/17.52
   expr2 b<0?(log(pow(2,-16))/log(2)+9.72)/17.52:b<pow(2,-15)?(log(pow(2,-16)+b*0.5)/log(2)+9.72)/17.52:(log(b)/log(2)+9.72)/17.52
   channel3 none
   name lin2log1
   label ACEScc
   xpos 200
   ypos 104
  }
push $Nd975d400
  Expression {
   expr0 r<(9.72-15)/17.52?(pow(2,(r*17.52-9.72))-pow(2,-16))*2:pow(2,(r*17.52-9.72))
   expr1 g<(9.72-15)/17.52?(pow(2,(g*17.52-9.72))-pow(2,-16))*2:pow(2,(g*17.52-9.72))
   expr2 b<(9.72-15)/17.52?(pow(2,(b*17.52-9.72))-pow(2,-16))*2:pow(2,(b*17.52-9.72))
   channel3 none
   name log2lin1
   label ACEScc
   xpos 80
   ypos 104
  }
  Switch {
   inputs 2
   which {{parent.operation}}
   name Operation1
   xpos 200
   ypos 190
  }
push $N78599200
  Expression {
   temp_name0 cut_lin
   temp_expr0 0.0078125
   temp_name1 cut_log
   temp_expr1 0.155251141552511
   temp_name2 A
   temp_expr2 10.5402377416545
   temp_name3 B
   temp_expr3 0.0729055341958355
   expr0 r<=cut_lin?A*r+B:(log(r)/log(2)+9.72)/17.52
   expr1 g<=cut_lin?A*g+B:(log(g)/log(2)+9.72)/17.52
   expr2 b<=cut_lin?A*b+B:(log(b)/log(2)+9.72)/17.52
   channel3 none
   name lin2log
   label ACEScct
   xpos -40
   ypos 108
  }
push $N78599200
  Expression {
   temp_name0 cut_lin
   temp_expr0 0.0078125
   temp_name1 cut_log
   temp_expr1 0.155251141552511
   temp_name2 A
   temp_expr2 10.5402377416545
   temp_name3 B
   temp_expr3 0.0729055341958355
   expr0 r<=cut_log?(r-B)/A:pow(2,r*17.52-9.72)
   expr1 g<=cut_log?(g-B)/A:pow(2,g*17.52-9.72)
   expr2 b<=cut_log?(b-B)/A:pow(2,b*17.52-9.72)
   channel3 none
   name log2lin
   label ACEScct
   selected true
   xpos -158
   ypos 105
  }
  Switch {
   inputs 2
   which {{parent.operation}}
   name Operation
   xpos -40
   ypos 190
  }
  Switch {
   inputs 3
   which {{parent.type}}
   name Type
   xpos -40
   ypos 312
  }
  Output {
   name Output
   xpos -40
   ypos 430
  }
push $Ne724a800
  Expression {
   temp_name0 StepsPerStop
   temp_expr0 50
   temp_name1 MidCVoffset
   temp_expr1 425
   temp_name2 CVmin
   temp_expr2 64
   temp_name3 CVmax
   temp_expr3 940
   expr0 (r<=pow(2,-9.72)?CVmin:max(CVmin,min(CVmax,rint(((log(r)/log(2)+2.5)*StepsPerStop+MidCVoffset)))))/1023
   channel3 none
   name lin2log2
   label "ACESproxy Matching CTL"
   xpos 557
   ypos 104
  }
 end_group
push $N78437200
 Expression {
  expr0 "start + y * increment"
  expr1 "start + y * increment"
  expr2 "start + y * increment"
  name Samples
  xpos -36
  ypos -161
  addUserKnob {20 User}
  addUserKnob {7 start}
  start {{parent.start_frequency}}
  addUserKnob {7 increment}
  increment {{"(parent.end_frequency - start) / parent.frequency_samples"}}
 }
 ColorLookup {
  lut {master {}
    red {curve x360 0.0001299 C 0.00014585 0.0001638 0.000184 0.00020669 0.0002321 0.00026073 0.00029307 0.00032939 0.00036991 0.0004149 0.00046416 0.00051899 0.00058185 0.00065523 0.0007416 0.00084503 0.00096453 0.00109495 0.00123115 0.001368 0.00150205 0.00164233 0.00180238 0.00199576 0.002236 0.00253539 0.0028926 0.00330083 0.00375324 0.004243 0.00476239 0.00533005 0.00597871 0.00674112 0.00765 0.00875137 0.01002888 0.0114217 0.01286901 0.01431 0.01570443 0.01714744 0.01878122 0.02074801 0.02319 0.02620736 0.02978248 0.03388092 0.03846824 0.04351 0.0489956 0.0550226 0.0617188 0.069212 0.07763 0.08695811 0.09717672 0.1084063 0.1207672 0.13438 0.1493582 0.16539571 0.1819831 0.19861101 0.21477 0.23018681 0.24487969 0.25877729 0.27180791 0.28389999 0.29494381 0.3048965 0.31378731 0.32164541 0.3285 0.3343513 0.33921009 0.34312129 0.3461296 0.34828001 0.3495999 0.3501474 0.35001299 0.349287 0.34806001 0.34637329 0.34426239 0.3418088 0.3390941 0.3362 0.33319771 0.33004111 0.32663569 0.32288679 0.31869999 0.3140251 0.30888399 0.3032904 0.2972579 0.29080001 0.28397009 0.27672139 0.2689178 0.26042271 0.2511 0.2408475 0.2298512 0.2184072 0.2068115 0.19536 0.18421359 0.1733273 0.16268811 0.1522833 0.14210001 0.1321786 0.1225696 0.1132752 0.1042979 0.09564 0.08729955 0.07930804 0.07171776 0.06458099 0.05795001 0.05186211 0.04628152 0.04115088 0.03641283 0.03201 0.0279172 0.0241444 0.020687 0.0175404 0.0147 0.01216179 0.00991996 0.00796724 0.00629635 0.0049 0.00377717 0.00294532 0.00242488 0.00223629 0.0024 0.00292552 0.00383656 0.00517484 0.00698208 0.0093 0.01214949 0.01553588 0.01947752 0.02399277 0.0291 0.03481485 0.04112016 0.04798504 0.05537861 0.06327 0.07163501 0.08046224 0.08973996 0.09945645 0.1096 0.1201674 0.1311145 0.1423679 0.15385421 0.1655 0.17725711 0.18914001 0.2011694 0.21336579 0.2257499 0.2383209 0.2510668 0.26399219 0.2771017 0.2904 0.30389121 0.31757259 0.33143839 0.3454828 0.35969999 0.37408391 0.3886396 0.4033784 0.41831151 0.43344989 0.44879529 0.46433601 0.480064 0.49597129 0.51205009 0.52829587 0.54469162 0.56120938 0.57782149 0.59450001 0.6112209 0.62797582 0.64476019 0.66156971 0.67839998 0.69523919 0.7120586 0.72882837 0.7455188 0.76209998 0.77854317 0.79482561 0.81092638 0.82682478 0.84249997 0.85793251 0.87308162 0.88789439 0.90231812 0.9163 0.9297995 0.94279838 0.95527762 0.96721792 0.97860003 0.9893856 0.99954879 1.00908923 1.01800644 1.02629995 1.03398275 1.04098594 1.04718804 1.05246675 1.05669999 1.05979443 1.06179917 1.06280684 1.0629096 1.06219995 1.06073523 1.05844355 1.05522442 1.05097675 1.04560006 1.03903687 1.03136074 1.02266622 1.0130477 1.00259995 0.99136752 0.97933137 0.96649158 0.9528479 0.93839997 0.92319399 0.90724403 0.89050198 0.87291998 0.85444993 0.83508402 0.814946 0.794186 0.77295399 0.75139999 0.72958362 0.70758879 0.68560219 0.66381037 0.64240003 0.62151492 0.6011138 0.58110517 0.56139767 0.54189998 0.52259952 0.50354642 0.4847436 0.46619391 0.4479 0.42986131 0.41209799 0.39464399 0.37753329 0.3608 0.34445629 0.32851681 0.31301919 0.29800111 0.28349999 0.26954481 0.25611839 0.2431896 0.2307272 0.21870001 0.2070971 0.19592319 0.1851708 0.1748323 0.1649 0.1553667 0.14623 0.13749 0.1291467 0.1212 0.1136397 0.106465 0.09969044 0.09333061 0.0874 0.08190096 0.07680428 0.07207712 0.06768664 0.0636 0.05980685 0.05628216 0.05297104 0.04981861 0.04677 0.04378405 0.04087536 0.03807264 0.03540461 0.0329 0.03056419 0.02838056 0.02634484 0.02445275 0.0227 0.02108429 0.01959988 0.01823732 0.01698717 0.01584 0.01479064 0.01383132 0.01294868 0.0121292 0.01135916 0.01062935 0.00993885 0.00928842 0.00867885 0.00811092 0.00758239 0.00708875 0.00662731 0.00619541 0.00579035 0.00540983 0.00505258 0.00471751 0.00440351 0.00410946 0.00383391 0.00357575 0.00333434 0.00310907 0.00289933 0.00270435 0.00252302 0.00235417 0.00219662 0.00204919 0.00191096 0.00178144 0.00166011 0.00154646 0.00143997 0.00134004 0.00124628 0.00115847 0.00107643 0.00099995 0.00092874 0.00086243 0.00080075 0.0007434 0.00069008 0.00064052 0.0005945 0.00055186 0.00051243 0.00047602 0.00044245 0.00041151 0.00038298 0.00035665 0.0003323 0.00030976 0.00028889 0.00026954 0.00025157 0.00023483 0.00021917 0.00020453 0.00019084 0.00017807 0.00016615 0.00015502 0.00014462 0.00013491 0.00012585 0.00011741 0.00010955 0.00010222 9.539e-05 8.902e-05 8.308e-05 7.751e-05 7.231e-05 6.746e-05 6.293e-05 5.871e-05 5.477e-05 5.11e-05 4.768e-05 4.449e-05 4.151e-05 3.873e-05 3.614e-05 3.372e-05 3.146e-05 2.935e-05 2.738e-05 2.552e-05 2.379e-05 2.218e-05 2.067e-05 1.927e-05 1.797e-05 1.675e-05 1.562e-05 1.456e-05 1.357e-05 1.265e-05 1.18e-05 1.1e-05 1.025e-05 9.56e-06 8.91e-06 8.31e-06 7.75e-06 7.22e-06 6.73e-06 6.28e-06 5.85e-06 5.46e-06 5.09e-06 4.74e-06 4.42e-06 4.12e-06 3.84e-06 3.58e-06 3.34e-06 3.11e-06 2.9e-06 2.71e-06 2.52e-06 2.35e-06 2.19e-06 2.04e-06 1.91e-06 1.78e-06 1.66e-06 1.54e-06 1.44e-06 1.34e-06 S 1.25e-06}
    green {curve x360 3.92e-06 C 4.39e-06 4.93e-06 5.53e-06 6.21e-06 k 6.97e-06 s0 7.81e-06 s0 8.77e-06 s0 9.84e-06 s0 1.104e-05 s0 1.239e-05 s0 1.389e-05 s0 1.556e-05 s0 1.744e-05 s0 1.958e-05 s0 2.202e-05 s0 2.484e-05 s0 2.804e-05 s0 3.153e-05 s0 3.522e-05 s0 3.9e-05 s0 4.283e-05 s0 4.691e-05 s0 5.159e-05 s0 5.718e-05 s0 6.4e-05 s0 7.234e-05 s0 8.221e-05 s0 9.351e-05 s0 0.00010614 s0 0.00012 s0 0.00013498 s0 0.00015149 s0 0.00017021 s0 0.00019182 s0 0.000217 s0 0.00024691 s0 0.00028124 s0 0.00031852 s0 0.00035727 s0 0.000396 s0 0.00043371 s0 0.00047302 s0 0.00051788 s0 0.00057222 s0 0.00064 s0 0.00072456 s0 0.0008255 s0 0.00094116 s0 0.00106988 s0 0.00121 s0 0.00136209 s0 0.00153075 s0 0.00172037 s0 0.00193532 s0 0.00218 s0 0.0024548 s0 0.002764 s0 0.0031178 s0 0.0035264 s0 0.004 s0 0.00454624 s0 0.00515932 s0 0.00582928 s0 0.00654616 s0 0.0073 s0 0.00808651 s0 0.00890872 s0 0.00976768 s0 0.01066443 s0 0.0116 s0 0.01257317 s0 0.01358272 s0 0.01462968 s0 0.01571509 s0 0.01684 s0 0.01800736 s0 0.01921448 s0 0.02045392 s0 0.02171824 s0 0.023 s0 0.02429461 s0 0.02561024 s0 0.02695857 s0 0.02835125 s0 0.0298 s0 0.03131083 s0 0.03288368 s0 0.03452112 s0 0.03622571 s0 0.038 s0 0.03984667 s0 0.041768 s0 0.043766 s0 0.04584267 s0 0.048 s0 0.05024368 s0 0.05257304 s0 0.05498056 s0 0.05745872 s0 0.06 s0 0.06260197 s0 0.06527752 s0 0.06804208 s0 0.07091109 s0 0.0739 s0 0.077016 s0 0.0802664 s0 0.0836668 s0 l 0.0872328 0.09098 0.09491755 0.09904584 0.1033674 0.1078846 0.1126 0.117532 0.1226744 0.12799279 0.1334528 0.13902 0.1446764 0.1504693 0.15646189 0.1627177 0.1693 0.1762431 0.18355811 0.1912735 0.19941799 0.20802 0.2171199 0.2267345 0.2368571 0.2474812 0.2586 0.2701849 0.28229389 0.2950505 0.30857801 0.32300001 0.33840209 0.35468581 0.37169859 0.3892875 0.4073 0.42562991 0.44430959 0.4633944 0.48293951 0.50300002 0.52356929 0.54451197 0.56568998 0.58696532 0.60820001 0.6293456 0.65030682 0.67087519 0.69084239 0.70999998 0.72818518 0.74546361 0.76196939 0.7778368 0.79320002 0.80811042 0.82249618 0.83630681 0.8494916 0.86199999 0.87381083 0.88496238 0.89549363 0.90544319 0.91485012 0.92373478 0.93209243 0.93992257 0.94722521 0.954 0.9602561 0.96600741 0.97126061 0.97602248 0.98030001 0.98409241 0.98741817 0.99031281 0.99281162 0.99495012 0.99671078 0.99809831 0.99911201 0.99974817 1 0.99985671 0.99930459 0.99832553 0.99689871 0.995 0.9926005 0.98974258 0.98644441 0.98272407 0.97860003 0.97408372 0.96917123 0.96385682 0.95813489 0.95200002 0.94545043 0.93849921 0.93116277 0.92345762 0.91540003 0.90700638 0.89827722 0.8892048 0.8797816 0.87 0.85986131 0.849392 0.83862197 0.82758129 0.81629997 0.80479473 0.793082 0.781192 0.76915473 0.75700003 0.74475408 0.73242241 0.7200036 0.70749652 0.69489998 0.68221921 0.66947162 0.65667439 0.64384478 0.63099998 0.61815548 0.60531437 0.59247559 0.57963789 0.5668 0.5539611 0.54113722 0.5283528 0.51563227 0.50300002 0.4904688 0.47803041 0.46567759 0.4534032 0.44119999 0.42908001 0.417036 0.40503201 0.39303201 0.38100001 0.36891839 0.3568272 0.34477681 0.33281761 0.32100001 0.30933809 0.2978504 0.28659359 0.27562451 0.26499999 0.25476319 0.2448896 0.2353344 0.22605281 0.21699999 0.20816161 0.1995488 0.1911552 0.1829744 0.175 0.1672235 0.15964641 0.1522776 0.1451259 0.1382 0.1315003 0.1250248 0.1187792 0.1127691 0.107 0.1014762 0.09618864 0.09112296 0.08626485 0.0816 0.07712064 0.07282552 0.06871008 0.06476976 0.061 0.05739621 0.05395504 0.05067376 0.04754965 0.04458 0.04175872 0.03908496 0.03656384 0.03420048 0.032 0.02996261 0.02807664 0.02632936 0.02470805 0.0232 0.02180077 0.02050112 0.01928108 0.01812069 0.017 0.01590379 0.01483718 0.01381068 0.01283478 0.01192 0.01106831 0.01027339 0.00953331 0.00884616 0.00821 0.00762378 0.00708542 0.00659148 0.00613848 0.005723 0.00534306 0.0049958 0.0046764 0.00438007 0.004102 0.00383845 0.0035891 0.00335422 0.00313409 0.002929 0.00273814 0.00255988 0.00239324 0.00223728 0.002091 0.00195359 0.00182458 0.00170358 0.00159019 0.001484 0.0013845 0.00129127 0.00120409 0.00112274 0.001047 0.00097659 0.00091111 0.00085013 0.00079324 0.00074 0.00069008 0.00064331 0.0005995 0.00055845 0.00052 0.00048391 0.00045005 0.00041835 0.00038872 0.0003611 0.00033538 0.00031144 0.00028917 0.00026845 0.0002492 0.0002313 0.00021469 0.00019929 0.00018505 0.0001719 0.00015978 0.0001486 0.0001383 0.00012879 0.00012 0.00011186 0.00010432 9.734e-05 9.085e-05 8.48e-05 7.915e-05 7.386e-05 6.892e-05 6.43e-05 6e-05 5.598e-05 5.223e-05 4.872e-05 4.545e-05 4.24e-05 3.956e-05 3.692e-05 3.445e-05 3.215e-05 3e-05 2.799e-05 2.611e-05 2.436e-05 2.272e-05 2.12e-05 1.978e-05 1.845e-05 1.722e-05 1.606e-05 1.499e-05 1.399e-05 1.305e-05 1.218e-05 1.136e-05 1.06e-05 9.89e-06 9.22e-06 8.59e-06 8.01e-06 7.47e-06 6.96e-06 6.49e-06 6.05e-06 5.64e-06 5.26e-06 4.9e-06 4.57e-06 4.26e-06 3.97e-06 3.7e-06 3.45e-06 3.22e-06 3e-06 2.8e-06 2.61e-06 2.43e-06 2.27e-06 2.11e-06 1.97e-06 1.84e-06 1.71e-06 1.6e-06 1.49e-06 1.39e-06 1.29e-06 1.21e-06 1.12e-06 1.05e-06 9.8e-07 9.1e-07 8.5e-07 7.9e-07 7.4e-07 6.9e-07 6.4e-07 6e-07 5.6e-07 5.2e-07 4.8e-07 S 4.5e-07}
    blue {curve x360 0.0006061 C 0.00068088 0.00076515 0.00086001 0.00096659 0.001086 0.00122059 0.00137273 0.00154358 0.00173429 0.001946 0.00217778 0.00243581 0.00273195 0.00307806 0.003486 0.00397523 0.00454088 0.00515832 0.00580291 0.00645 0.00708322 0.00774549 0.00850115 0.00941454 0.01054999 0.0119658 0.01365587 0.01558805 0.01773015 0.02005001 0.02251136 0.02520288 0.02827972 0.03189704 0.03621 0.04143771 0.04750372 0.05411988 0.06099803 0.06785001 0.07448632 0.08136156 0.08915364 0.09854048 0.1102 0.1246133 0.1417017 0.16130351 0.1832568 0.20739999 0.23369209 0.26261139 0.29477459 0.33079851 0.37130001 0.4162091 0.4654642 0.51969481 0.5795303 0.64560002 0.71848381 0.79671329 0.87784588 0.95943898 1.0390501 1.11536729 1.18849707 1.25812328 1.32392955 1.38559997 1.44263518 1.49480355 1.54219031 1.58488071 1.62295997 1.65640485 1.68529594 1.70987451 1.73038209 1.74705994 1.76004458 1.76962328 1.77626371 1.78043342 1.78260004 1.78296816 1.78169978 1.77919817 1.7758671 1.77210998 1.76825893 1.76403904 1.7589438 1.75246632 1.74409997 1.73355949 1.7208581 1.70593691 1.68873715 1.66919994 1.64752865 1.62341273 1.59602225 1.56452799 1.52810001 1.4861114 1.43952155 1.38987994 1.33873618 1.28763998 1.23742235 1.18782425 1.13876104 1.09014797 1.04190004 0.99419761 0.94734728 0.90145308 0.8566193 0.81295007 0.77051729 0.7294448 0.68991357 0.65210491 0.61619997 0.58232862 0.55041617 0.52033758 0.49196729 0.46518001 0.4399246 0.41618359 0.39388219 0.3729459 0.35330001 0.33485779 0.31755209 0.30133751 0.28616861 0.27200001 0.25881711 0.2464838 0.2347718 0.2234533 0.2123 0.20116919 0.19011959 0.1792254 0.1685608 0.1582 0.1481383 0.1383758 0.1289942 0.1200751 0.1117 0.1039048 0.09666748 0.08998272 0.08384531 0.07824999 0.07320899 0.06867816 0.06456784 0.06078835 0.05725001 0.05390435 0.05074664 0.04775276 0.04489859 0.04216 0.03950728 0.03693564 0.03445836 0.03208872 0.02984 0.02771181 0.02569444 0.02378716 0.02198925 0.0203 0.01871805 0.01724036 0.01586364 0.01458461 0.0134 0.01230723 0.01130188 0.01037792 0.00952931 0.00875 0.0080352 0.0073816 0.0067854 0.0062428 0.00575 0.0053036 0.0048998 0.0045342 0.0042024 0.0039 0.0036232 0.0033706 0.0031414 0.0029348 0.00275 0.0025852 0.0024386 0.0023094 0.0021968 0.0021 0.00201773 0.0019482 0.0018898 0.00184093 0.0018 0.00176627 0.0017378 0.0017112 0.00168307 0.00165 0.00161013 0.0015644 0.0015136 0.00145853 0.0014 0.00133667 0.00127 0.001205 0.00114667 0.0011 0.0010688 0.0010494 0.0010356 0.0010212 0.001 0.00096864 0.00092992 0.00088688 0.00084256 0.0008 0.00076096 0.00072368 0.00068592 0.00064544 0.0006 0.00054787 0.0004916 0.0004354 0.00038347 0.00034 0.00030725 0.00028316 0.00026544 0.00025181 0.00024 0.00022955 0.00022064 0.00021196 0.00020219 0.00019 0.00017421 0.00015564 0.00013596 0.00011685 0.0001 8.613e-05 7.46e-05 6.5e-05 5.693e-05 5e-05 4.416e-05 3.948e-05 3.572e-05 3.264e-05 3e-05 2.765e-05 2.556e-05 2.364e-05 2.181e-05 2e-05 1.813e-05 1.62e-05 1.42e-05 1.213e-05 1e-05 7.73e-06 5.4e-06 3.2e-06 1.33e-06 0 0 0 0 0 0 0 0 S 0}
    alpha {}}
  name CMF_Lookup
  label "CIE 1931 2 deg\n360-830nm"
  xpos -36
  ypos -137
 }
 Colorspace {
  colorspace_in CIE-XYZ
  colorspace_out CIE-Yxy
  name XYZ_to_Yxy
  xpos -36
  ypos -95
 }
 Expression {
  temp_name0 freq
  temp_expr0 "height - purples"
  expr1 "y < freq ? g : start.x + (y - freq) * (end.x - start.x) / purples"
  expr2 "y < freq ? b : start.y + (y - freq) * (end.y - start.y) / purples"
  name Purples
  xpos -36
  ypos -56
  addUserKnob {20 User}
  addUserKnob {12 start}
  start {0.73469 0.26531}
  addUserKnob {12 end}
  end {0.17411 0.00496}
  addUserKnob {3 purples}
  purples {{parent.purple_samples}}
 }
 Shuffle2 {
  inputs 2
  fromInput1 {{0} B A}
  in1 rgb
  fromInput2 {{1} B A}
  in2 rgb
  mappings "4 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 white -1 -1 rgba.alpha 0 3 rgba.red 1 0 rgba.red 0 0"
  name Shuffle1
  xpos -36
  ypos 5
 }
 Colorspace {
  colorspace_in CIE-Yxy
  illuminant_out ACES
  primary_out ACES
  name Yxy_to_ACES
  xpos -36
  ypos 37
 }
 Output {
  name Output1
  xpos -36
  ypos 93
 }
end_group
Group {
 inputs 0
 name Grad
 xpos 370
 ypos -218
 addUserKnob {20 User}
 addUserKnob {41 format T Constant2.format}
 addUserKnob {41 output T Ramp1.output}
}
 Constant {
  inputs 0
  channels rgb
  color {0 0 0 1}
  format "1920 1080 0 0 1920 1080 1 HD_1080"
  name Constant2
  selected true
  xpos -116
  ypos -240
 }
 Ramp {
  output rgb
  p0 {0 0}
  p1 {{width-1} 0}
  name Ramp1
  xpos -116
  ypos -147
 }
 Output {
  name Output1
  xpos -116
  ypos -68
 }
end_group
CMSTestPattern {
 inputs 0
 cube_size 17
 name CMSTestPattern1
 xpos 30
 ypos -244
}
Dot {
 name Dot2
 xpos 64
 ypos -115
}
set Nab696800 [stack 0]
Group {
 name RGB_to_JMh
 xpos 30
 ypos -27
 addUserKnob {20 User}
 addUserKnob {41 colorspace_in l input T In_to_XYZ.colorspace_in}
 addUserKnob {41 illuminant_in l "" -STARTLINE T In_to_XYZ.illuminant_in}
 addUserKnob {41 primary_in l "" -STARTLINE T In_to_XYZ.primary_in}
 addUserKnob {41 "JMhKernel_Adapting Field" l "Adapting Field" T "XYZ_to_JMh.JMhKernel_Adapting Field"}
 addUserKnob {41 JMhKernel_Background l Background T XYZ_to_JMh.JMhKernel_Background}
 addUserKnob {41 JMhKernel_Surround l Surround T XYZ_to_JMh.JMhKernel_Surround}
 addUserKnob {41 JMhKernel_discountIlluminant l discountIlluminant T XYZ_to_JMh.JMhKernel_discountIlluminant}
 addUserKnob {41 JMhKernel_compressMode l compressMode T XYZ_to_JMh.JMhKernel_compressMode}
 addUserKnob {41 JMhKernel_HK_mode l HK_mode T XYZ_to_JMh.JMhKernel_HK_mode}
 addUserKnob {41 matrix T XYZ_to_JMh.matrix}
}
 Input {
  inputs 0
  name Input1
  xpos -29
  ypos -211
 }
 Colorspace {
  colorspace_out CIE-XYZ
  illuminant_out ACES
  name In_to_XYZ
  xpos -29
  ypos -171
 }
 Multiply {
  channels rgb
  value 100
  name Multiply1
  label "\[value value]"
  xpos -29
  ypos -122
 }
 BlinkScript {
  recompileCount 106
  ProgramGroup 1
  KernelDescription "3 \"JMhKernel\" iterate pixelWise c1ef0a651ca8198fcab8bd2bf162260b11e377e9b18f648109e108056b305476 2 \"src\" Read Point \"dst\" Write Point 8 \"Ref White XYZ\" Float 3 neBzPwAAgD8vIYE/AAAAAA== \"Adapting Field\" Float 1 AADIQg== \"Background\" Float 1 AADIQg== \"Surround\" Float 3 ZmZmPz0KFz9mZmY/AAAAAA== \"discountIlluminant\" Bool 1 AA== \"compressMode\" Bool 1 AA== \"HK_mode\" Bool 1 AA== \"matrix\" Int 1 AAAAAA== 8 \"XYZ_w\" 3 1 Default \"L_A\" 1 1 Default \"Y_b\" 1 1 Default \"surround\" 3 1 Default \"discountIlluminant\" 1 1 Default \"compressMode\" 1 1 Default \"HK_mode\" 1 1 Default \"matrix\" 1 1 Default 1 \"coefficients\" Float 3 1 AAAAAAAAAAAAAAAAAAAAAA=="
  kernelSource "#include \"/Users/nick/github/aces-ot-vwg-experiments/nuke/lib_hellwig.rpp\"\n\nkernel JMhKernel : ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessPoint, eEdgeClamped> src; // the input image\n  Image<eWrite> dst; // the output image\n\n  param:\n    float3 XYZ_w;\n    float L_A;\n    float Y_b;\n    float3 surround;\n    bool discountIlluminant;\n    bool compressMode;\n    bool HK_mode;\n    int matrix;\n\n  local:\n    float3 coefficients;  // This local variable is not exposed to the user.\n\n  // In define(), parameters can be given labels and default values.\n  void define() \{\n    defineParam(XYZ_w, \"Ref White XYZ\", \{0.9526460745698462f, 1.0f, 1.0088251843515859f\});\n    defineParam(L_A, \"Adapting Field\", 100.0f);\n    defineParam(Y_b, \"Background\", 100.0f);\n    defineParam(surround, \"Surround\", \{0.9f, 0.59f, 0.9f\});\n  \}\n\n  // The init() function is run before any calls to process().\n  // Local variables can be initialized here.\n  void init() \{\n  \}\n\n  void process() \{\n    // Read the input image\n    SampleType(src) input = src();\n\n    // Isolate the RGB components\n    float3 srcPixel(input.x, input.y, input.z);\n\n    // Apply XYZ to JMh\n    float3 destPixel = XYZ_to_Hellwig2022_JMh( srcPixel, XYZ_w, L_A,  Y_b, surround, discountIlluminant, compressMode, HK_mode, matrix);\n\n    // Write the result to the output image\n    dst() = float4(destPixel.x, destPixel.y, destPixel.z, input.w);\n  \}\n\};\n"
  rebuild ""
  "JMhKernel_Ref White XYZ" {{"In_to_XYZ.colormatrix.0 + In_to_XYZ.colormatrix.1 + In_to_XYZ.colormatrix.2"} {"In_to_XYZ.colormatrix.3 + In_to_XYZ.colormatrix.4 + In_to_XYZ.colormatrix.5"} {"In_to_XYZ.colormatrix.6 + In_to_XYZ.colormatrix.7 + In_to_XYZ.colormatrix.8"}}
  JMhKernel_Background 20
  JMhKernel_Surround {0.9 0.59 0.9}
  JMhKernel_discountIlluminant true
  JMhKernel_matrix {{matrix}}
  rebuild_finalise ""
  name XYZ_to_JMh
  selected true
  xpos -29
  ypos -55
  addUserKnob {20 User}
  addUserKnob {4 matrix M {Stock Thomas Pekka}}
  addUserKnob {41 "JMhKernel_Ref White XYZ_1" l "Ref White XYZ" T "XYZ_to_JMh.JMhKernel_Ref White XYZ"}
  addUserKnob {41 "JMhKernel_Adapting Field_1" l "Adapting Field" T "XYZ_to_JMh.JMhKernel_Adapting Field"}
  addUserKnob {41 JMhKernel_Background_1 l Background T XYZ_to_JMh.JMhKernel_Background}
  addUserKnob {41 JMhKernel_Surround_1 l Surround T XYZ_to_JMh.JMhKernel_Surround}
  addUserKnob {41 JMhKernel_discountIlluminant_1 l discountIlluminant T XYZ_to_JMh.JMhKernel_discountIlluminant}
  addUserKnob {41 JMhKernel_compressMode_1 l compressMode T XYZ_to_JMh.JMhKernel_compressMode}
  addUserKnob {41 JMhKernel_HK_mode_1 l HK_mode T XYZ_to_JMh.JMhKernel_HK_mode}
 }
 Output {
  name Output1
  xpos -29
  ypos 35
 }
end_group
set N10206a00 [stack 0]
Group {
 name JMh_to_RGB
 xpos 30
 ypos 96
 addUserKnob {20 User}
 addUserKnob {41 colorspace_out l output T Out_to_XYZ.colorspace_in}
 addUserKnob {41 illuminant_out l "" -STARTLINE T Out_to_XYZ.illuminant_in}
 addUserKnob {41 primary_out l "" -STARTLINE T Out_to_XYZ.primary_in}
 addUserKnob {41 "XYZKernel_Adapting Field" l "Adapting Field" T "JMh_to_XYZ.XYZKernel_Adapting Field"}
 addUserKnob {41 XYZKernel_Background l Background T JMh_to_XYZ.XYZKernel_Background}
 addUserKnob {41 XYZKernel_Surround l Surround T JMh_to_XYZ.XYZKernel_Surround}
 addUserKnob {41 XYZKernel_discountIlluminant l discountIlluminant T JMh_to_XYZ.XYZKernel_discountIlluminant}
 addUserKnob {41 XYZKernel_compressMode l compressMode T JMh_to_XYZ.XYZKernel_compressMode}
 addUserKnob {41 XYZKernel_HK_mode l HK_mode T JMh_to_XYZ.XYZKernel_HK_mode}
 addUserKnob {41 matrix T JMh_to_XYZ.matrix}
}
 Colorspace {
  inputs 0
  colorspace_in sRGB
  colorspace_out CIE-XYZ
  illuminant_out ACES
  name Out_to_XYZ
  xpos -12
  ypos -19
 }
 Input {
  inputs 0
  name Input1
  xpos -136
  ypos -199
 }
 BlinkScript {
  recompileCount 101
  ProgramGroup 1
  KernelDescription "3 \"XYZKernel\" iterate pixelWise 7f021cb2097444f30bd8d6ccd0cd4f4775b159eaaf2c7f16df7caa587a99f876 2 \"src\" Read Point \"dst\" Write Point 8 \"Ref White XYZ\" Float 3 neBzPwAAgD8vIYE/AAAAAA== \"Adapting Field\" Float 1 AADIQg== \"Background\" Float 1 AADIQg== \"Surround\" Float 3 ZmZmPz0KFz9mZmY/AAAAAA== \"discountIlluminant\" Bool 1 AA== \"compressMode\" Bool 1 AA== \"HK_mode\" Bool 1 AA== \"matrix\" Int 1 AAAAAA== 8 \"XYZ_w\" 3 1 Default \"L_A\" 1 1 Default \"Y_b\" 1 1 Default \"surround\" 3 1 Default \"discountIlluminant\" 1 1 Default \"compressMode\" 1 1 Default \"HK_mode\" 1 1 Default \"matrix\" 1 1 Default 1 \"coefficients\" Float 3 1 AAAAAAAAAAAAAAAAAAAAAA=="
  kernelSource "#include \"/Users/nick/github/aces-ot-vwg-experiments/nuke/lib_hellwig.rpp\"\n\nkernel XYZKernel : ImageComputationKernel<ePixelWise>\n\{\n  Image<eRead, eAccessPoint, eEdgeClamped> src; // the input image\n  Image<eWrite> dst; // the output image\n\n  param:\n    float3 XYZ_w;\n    float L_A;\n    float Y_b;\n    float3 surround;\n    bool discountIlluminant;\n    bool compressMode;\n    bool HK_mode;\n    int matrix;\n\n  local:\n    float3 coefficients;  // This local variable is not exposed to the user.\n\n  // In define(), parameters can be given labels and default values.\n  void define() \{\n    defineParam(XYZ_w, \"Ref White XYZ\", \{0.9526460745698462f, 1.0f, 1.0088251843515859f\});\n    defineParam(L_A, \"Adapting Field\", 100.0f);\n    defineParam(Y_b, \"Background\", 100.0f);\n    defineParam(surround, \"Surround\", \{0.9f, 0.59f, 0.9f\});\n  \}\n\n  // The init() function is run before any calls to process().\n  // Local variables can be initialized here.\n  void init() \{\n  \}\n\n  void process() \{\n    // Read the input image\n    SampleType(src) input = src();\n\n    // Isolate the RGB components\n    float3 srcPixel(input.x, input.y, input.z);\n\n    // Apply XYZ to JMh\n    float3 destPixel = Hellwig2022_JMh_to_XYZ( srcPixel, XYZ_w, L_A,  Y_b, surround, discountIlluminant, compressMode, HK_mode, matrix);\n\n    // Write the result to the output image\n    dst() = float4(destPixel.x, destPixel.y, destPixel.z, input.w);\n  \}\n\};\n"
  rebuild ""
  "XYZKernel_Ref White XYZ" {{"Out_to_XYZ.colormatrix.0 + Out_to_XYZ.colormatrix.1 + Out_to_XYZ.colormatrix.2"} {"Out_to_XYZ.colormatrix.3 + Out_to_XYZ.colormatrix.4 + Out_to_XYZ.colormatrix.5"} {"Out_to_XYZ.colormatrix.6 + Out_to_XYZ.colormatrix.7 + Out_to_XYZ.colormatrix.8"}}
  XYZKernel_Background 20
  XYZKernel_Surround {0.9 0.59 0.9}
  XYZKernel_discountIlluminant true
  XYZKernel_compressMode true
  XYZKernel_matrix {{matrix}}
  rebuild_finalise ""
  name JMh_to_XYZ
  xpos -136
  ypos -125
  addUserKnob {20 User}
  addUserKnob {4 matrix M {Stock Thomas Pekka}}
  addUserKnob {41 "XYZKernel_Ref White XYZ_1" l "Ref White XYZ" T "JMh_to_XYZ.XYZKernel_Ref White XYZ"}
  addUserKnob {41 "XYZKernel_Adapting Field_1" l "Adapting Field" T "JMh_to_XYZ.XYZKernel_Adapting Field"}
  addUserKnob {41 XYZKernel_Background_1 l Background T JMh_to_XYZ.XYZKernel_Background}
  addUserKnob {41 XYZKernel_Surround_1 l Surround T JMh_to_XYZ.XYZKernel_Surround}
  addUserKnob {41 XYZKernel_discountIlluminant_1 l discountIlluminant T JMh_to_XYZ.XYZKernel_discountIlluminant}
  addUserKnob {41 XYZKernel_compressMode_1 l compressMode T JMh_to_XYZ.XYZKernel_compressMode}
  addUserKnob {41 XYZKernel_HK_mode_1 l HK_mode T JMh_to_XYZ.XYZKernel_HK_mode}
 }
 Multiply {
  channels rgb
  value 0.01
  name Multiply4
  label "\[value value]"
  xpos -136
  ypos -69
 }
 ColorMatrix {
  matrix {
      {{parent.Out_to_XYZ.colormatrix.0} {parent.Out_to_XYZ.colormatrix.1} {parent.Out_to_XYZ.colormatrix.2}}
      {{parent.Out_to_XYZ.colormatrix.3} {parent.Out_to_XYZ.colormatrix.4} {parent.Out_to_XYZ.colormatrix.5}}
      {{parent.Out_to_XYZ.colormatrix.6} {parent.Out_to_XYZ.colormatrix.7} {parent.Out_to_XYZ.colormatrix.8}}
    }
  invert true
  name outMatrix
  xpos -136
  ypos -18
 }
 Colorspace {
  colorspace_out {{Out_to_XYZ.colorspace_in}}
  name outCurve
  xpos -136
  ypos 19
 }
 Output {
  name Output1
  selected true
  xpos -136
  ypos 80
 }
end_group
set N100b9400 [stack 0]
PlotChromaticity {
 name PlotChromaticity2
 xpos 267
 ypos 96
 input_gamut ACES
 draw_planckian_locus false
}
push $N10206a00
Expression {
 expr0 "g * cos(b)"
 expr1 r
 expr2 "g * sin(b)"
 name polar_to_rect
 xpos -156
 ypos -27
}
push $Nab696800
Dot {
 name Dot1
 xpos -337
 ypos -115
}
Dot {
 name Dot3
 xpos -337
 ypos 100
}
PositionToPoints2 {
 inputs 2
 selectable false
 cast_shadow false
 receive_shadow false
 P_channel rgb
 detail 1
 pointSize 3
 name PositionToPoints1
 xpos -156
 ypos 97
}
push $N100b9400
Viewer {
 inputs 3
 frame 1
 frame_range 1-100
 input_number 1
 colour_sample_bbox {0.6770833135 -0.2697916627 0.6781250238 -0.2687500119}
 samplepoints {{0.4093750119 -0.181250006}
   }
 gl_buffer_depth half-float
 viewerProcess None
 input_process_node JMh_scale
 input_process false
 monitorOutOutputTransform rec709
 name Viewer1
 xpos 30
 ypos 225
}
Read {
 inputs 0
 file_type exr
 file /Volumes/SSD_4TB_01/images1/MISC/IsabellaAsReference_AP0.exr
 format "1920 1080 0 0 1920 1080 1 HD_1080"
 origset true
 name Read1
 xpos -158
 ypos -247
}
Multiply {
 inputs 0
 value {{1/100} {1/100} {0.5/PI} 1}
 name JMh_scale
 xpos -500
 ypos -33
}
